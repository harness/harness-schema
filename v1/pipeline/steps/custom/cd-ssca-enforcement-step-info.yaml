title: CdSscaEnforcementStepInfo
allOf:
- $ref: ../../common/step-spec-type.yaml
- type: object
  properties:
    description:
      desc: This is the description for CdSscaEnforcementStepInfo
    infrastructure:
      oneOf:
      - $ref: container-k8s-infra.yaml
    policy:
      oneOf:
        - $ref: ../custom/enforcement-policy.yaml
        - type: object
          properties:
            policySet:
              type: string
          description:
            desc: The reference of the SBOM OPA policy set.
    source:
      $ref: sbom-source.yaml
    verifyAttestation:
      $ref: verify-attestation.yaml
$schema: http://json-schema.org/draft-07/schema#
type: object
required:
- infrastructure
- policy
- source
- verifyAttestation

