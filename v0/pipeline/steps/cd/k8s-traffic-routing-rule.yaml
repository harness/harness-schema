title: K8sTrafficRoutingRouteRule
type: object
required:
  - type
  - spec
properties:
  type:
    type: string
    enum:
      - uri
      - method
      - header
      - port
      - scheme
      - authority
$schema: http://json-schema.org/draft-07/schema#
allOf:
  - if:
      properties:
        type:
          const: uri
    then:
      properties:
        spec:
          title: K8sTrafficRoutingRuleURISpec
          type: object
          required:
            - name
            - value
          properties:
            name:
              type: string
            value:
              type: string
            matchType:
              type: string
              enum:
                - exact
                - prefix
                - regex
          $schema: http://json-schema.org/draft-07/schema#
  - if:
      properties:
        type:
          const: method
    then:
      properties:
        spec:
          title: K8sTrafficRoutingRuleMethodSpec
          type: object
          required:
            - name
            - value
          properties:
            name:
              type: string
            value:
              type: string
              enum:
                - GET
                - POST
                - PUT
                - DELETE
                - HEAD
                - CONNECT
                - OPTION
                - TRACE
                - PATCH
            matchType:
              type: string
              enum:
                - exact
                - prefix
                - regex
      $schema: http://json-schema.org/draft-07/schema#
  - if:
      properties:
        type:
          const: header
    then:
      properties:
        spec:
          title: K8sTrafficRoutingRuleHeaderSpec
          type: object
          required:
            - name
            - values
          properties:
            name:
              type: string
            values:
              type: array
              items:
                minLength: 1
                type: object
                required:
                  - key
                  - value
                properties:
                  key:
                    type: string
                  value:
                    type: string
                  matchType:
                    type: string
                    enum:
                      - exact
                      - prefix
                      - regex
                  $schema: http://json-schema.org/draft-07/schema#
          $schema: http://json-schema.org/draft-07/schema#
  - if:
      properties:
        type:
          const: port
    then:
      properties:
        spec:
          title: K8sTrafficRoutingRulePortSpec
          type: object
          required:
            - name
            - value
          properties:
            name:
              type: string
            value:
              type: number
      $schema: http://json-schema.org/draft-07/schema#
  - if:
      properties:
        type:
          const: scheme
    then:
      properties:
        spec:
          title: K8sTrafficRoutingRuleSchemeSpec
          type: object
          required:
            - name
            - value
          properties:
            name:
              type: string
            value:
              type: string
            matchType:
              type: string
              enum:
                - exact
                - prefix
                - regex
          $schema: http://json-schema.org/draft-07/schema#
  - if:
      properties:
        type:
          const: authority
    then:
      properties:
        spec:
          title: K8sTrafficRoutingRuleAuthoritySpec
          type: object
          required:
            - name
            - value
          properties:
            name:
              type: string
            value:
              type: string
            matchType:
              type: string
              enum:
                - exact
                - prefix
                - regex
          $schema: http://json-schema.org/draft-07/schema#
